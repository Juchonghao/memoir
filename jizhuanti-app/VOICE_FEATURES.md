# AI记者语音访谈应用 - 语音功能使用指南

## 项目信息
- **项目名称**: AI记者语音访谈应用（语音对话版）
- **部署URL**: https://0kcpiov9wof8.space.minimaxi.com
- **原版本URL**: https://8xttc66e8u0a.space.minimaxi.com
- **开发时间**: 2025-10-31

## 新增功能概览

本次更新在原有AI记者访谈功能基础上，新增了完整的语音对话能力，让用户可以通过语音与AI记者进行更自然的交流。

### 核心功能

#### 1. 语音识别 (Speech-to-Text)
- **技术**: Web Speech API
- **语言**: 中文 (zh-CN)
- **模式**: 连续识别，实时显示识别结果
- **交互方式**: 点击麦克风按钮开始录音，再次点击停止

#### 2. 语音合成 (Text-to-Speech)
- **技术**: Web Speech API
- **语言**: 中文女声
- **自动播放**: AI回复时自动转换为语音播放
- **播放控制**: 支持暂停/继续/停止

#### 3. 混合交互模式
- 支持语音输入和文本输入混合使用
- 语音识别结果自动填入文本框
- 文本和语音同步显示

## 使用说明

### 访谈页面语音功能

#### 录音按钮
- **位置**: 输入框左侧，蓝紫渐变色的麦克风按钮
- **开始录音**: 点击麦克风按钮
- **停止录音**: 再次点击按钮（变红色并闪烁时）
- **录音状态**: 录音时显示红色状态栏，带动画效果和实时识别文本

#### 语音播放控制
- **自动播放**: AI回复后自动播放语音（可通过开关控制）
- **播放状态**: 显示蓝色状态栏，带播放图标动画
- **暂停/继续**: 点击暂停按钮可暂停/继续播放
- **停止播放**: 点击停止按钮立即停止语音

#### 功能开关
- **自动播放AI语音**: 勾选后，AI每次回复都会自动播放语音
- **位置**: 输入区域底部

## 浏览器兼容性

### 完全支持
- Google Chrome (推荐)
- Microsoft Edge
- Safari (iOS/macOS)

### 功能限制
- Firefox: 语音识别功能可能不可用
- 其他浏览器: 建议使用Chrome获得最佳体验

### 权限要求
- **麦克风权限**: 首次使用语音识别时，浏览器会请求麦克风权限，请允许
- **HTTPS**: 语音识别需要在HTTPS环境下运行（已满足）

## 技术实现

### 新增文件
1. `src/hooks/useVoiceRecognition.ts` - 语音识别Hook
2. `src/hooks/useSpeechSynthesis.ts` - 语音合成Hook

### 修改文件
1. `src/pages/InterviewPage.tsx` - 集成语音功能到访谈页面

### 关键技术点
- Web Speech API (SpeechRecognition)
- Web Speech API (SpeechSynthesis)
- React Hooks 状态管理
- 实时语音识别结果处理
- 自动语音播放机制

## 用户体验优化

### 状态反馈
- 录音时：红色闪烁状态栏 + 动画波形
- 播放时：蓝色状态栏 + 音量图标动画
- 识别中：实时显示识别文本
- 错误提示：黄色警告栏显示错误信息

### 交互细节
- 录音时自动停止AI语音播放，避免干扰
- 录音时禁用文本输入框和发送按钮
- 识别完成后自动填入文本框，方便编辑
- 支持Shift+Enter换行，Enter发送

### 降级方案
- 不支持语音识别时，显示提示信息并保留文本输入
- 不支持语音合成时，只显示文字，不播放语音
- 浏览器不兼容时，完全降级为纯文本对话模式

## 测试建议

### 基础功能测试
1. 访问网站，完成登录/注册
2. 选择任意章节进入访谈页面
3. 点击麦克风按钮，说话测试语音识别
4. 检查识别结果是否准确
5. 发送消息，检查AI回复是否自动播放语音

### 语音控制测试
1. AI播放语音时，点击暂停按钮
2. 点击继续按钮，确认播放恢复
3. 点击停止按钮，确认立即停止

### 混合模式测试
1. 使用语音输入一次
2. 使用文本输入一次
3. 切换"自动播放"开关，测试不同模式

### 移动端测试
1. 使用手机浏览器访问
2. 测试语音录音功能
3. 测试语音播放功能
4. 检查UI在小屏幕上的显示

## 已知限制

1. **浏览器限制**: Firefox浏览器可能不支持Web Speech API
2. **网络要求**: 语音识别需要网络连接（调用浏览器内置API）
3. **语音质量**: 识别准确度受环境噪音和发音清晰度影响
4. **语音选择**: 自动选择系统可用的中文女声，不同设备可能略有差异

## 故障排除

### 语音识别不工作
- 检查浏览器是否支持（使用Chrome）
- 检查麦克风权限是否允许
- 检查麦克风设备是否正常
- 尝试刷新页面重新授权

### 语音播放无声音
- 检查设备音量是否打开
- 检查浏览器是否静音
- 确认"自动播放AI语音"开关已开启
- 检查系统TTS语音库是否安装

### 识别结果不准确
- 在安静环境下使用
- 说话清晰，语速适中
- 确保麦克风距离合适
- 避免方言，使用普通话

## 后续优化建议

1. 添加语音识别语言选择（普通话/粤语/英语等）
2. 添加语音合成语速/音调调节
3. 支持语音命令（如"发送"、"删除"等）
4. 添加语音录音时长显示和限制
5. 支持离线语音识别（可选）
